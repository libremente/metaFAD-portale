/* global OpenSeadragon, _, METAFAD_VIEWER_CONFIG */
!function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/metaMediaViewerCustom/metaMediaViewer.html",scope:{medias:"=",mediasGrid:"=",index:"=",tot:"=",totFolder:"=",itemInPage:"=",options:"=",info:"=",titleMetadato:"="},controller:i,controllerAs:"metaMediaViewer",bindToController:!0,replace:!0};return e}function i(e,i,a,t,n,o,r,d,s,c,l,m,g,u,v){var f,p=this;p.singleMetadato=!1,p.showBtnEcommerce=METAFAD_VIEWER_CONFIG.popupEcommerce,p.showEcommerce=!1,p.iframeEcommerceUrl,p.loadingMedia=!1,p.bodyStyle=METAFAD_VIEWER_CONFIG.containerBg?"background:"+METAFAD_VIEWER_CONFIG.containerBg:"",p.btnOptions=METAFAD_VIEWER_CONFIG.buttonHeader,p.mediaViewerOptions={modal:!1,height:"100%",hideHeader:!0},p.pagination=METAFAD_VIEWER_CONFIG.pagination,p.manageEcommerce=function(){p.showEcommerce=!p.showEcommerce,p.iframeEcommerceUrl=t.trustAsResourceUrl(METAFAD_VIEWER_CONFIG.popupEcommerce+"?id="+l.metadato+"&type="+l.typeMetadato+"&mediaId="+p.media.id)},p.zoomSupported="zoom"in document.body.style;var w=function(){r(function(){s.initTree("viewerIndex",p.treeConfig,p.index,!0,null),i.$emit("metaMediaViewer:scroll")},1e3),f=_.clone(p.medias),p.setMedia(1),1===f.length&&(p.singleMetadato=!0)};i.$watch("metaMediaViewer.medias",function(e){f.length<e.length?f=_.clone(e):(f.splice(0,e.length),f=e.concat(f))}),p.modalMode=p.options.modal,p.btnClose=p.options.modal&&p.options.btnClose,p.contentHeight=!p.modalMode&&p.options.height,p.contentHeightNoTollbar=parseInt(p.contentHeight)-38+"px",i.$watch("metaMediaViewer.options.height",function(e){p.contentHeight=p.modalMode?"":e,p.bodyHeight=angular.element(n.find(".body")).height()});var M=e.$on("detectScrollEnd:bottom",function(){if(!p.showLoading&&!(p.folderActive&&p.mediasGrid.length>=p.totFolder||p.mediasGrid.length>=p.tot)){p.showLoading=!0;var e=p.folderActive&&p.folderActive.key;i.$emit("metaMediaViewer:nextPage",e,"mediasGrid")}});p.showLoading=!1;var b=i.$on("viewer:loaded:nextPage",function(e){p.showLoading=!1});p.close=function(){n.remove();var e=p.options.fnClosePrm;p.options.fnClose.apply(this,e)},p.view="single-page",p.setView=function(e){p.view=e,"double-page"===e&&h()},p.doubleMedia=[];var h=function(){p.doubleMedia=[];var e={1:0,2:1},i=p.media.side?e[p.media.side]:!1,a=_.findIndex(f,{id:p.media.id});if(i&&0!==i){if(!f[a-1])return void x(a-1,"setDoublePage");p.doubleMedia[1]=p.media,p.doubleMedia[0]=f[a-1]}else{if(!f[a+1])return void x(a+1,"setDoublePage");p.doubleMedia[0]=p.media,p.doubleMedia[1]=f[a+1]}p.bodyHeight=angular.element(n.find(".body")).height()};p.loadSingleMedia=function(e){p.view="single-page",p.setMedia(e+1)},p.currentMedia=1,p.totalMedias=p.medias.length,p.media=null,p.prev=!1,p.next=!1,p.viewer;var V,x=function(e,i){var t,n,o=l.typeMetadato;"query"===METAFAD_VIEWER_CONFIG.idType?(t="",n=l.metadato):(t=l.metadato,n=null),c.getMetadato(t,n,e,1,o).then(function(a){try{a.physicalSTRU.image[0].id||(a.physicalSTRU.image[0].id=g.create()),f[e]=a.physicalSTRU.image[0],"setMedia"===i?p.setMedia(e+1,null):"setDoublePage"===i&&h()}catch(t){}},function(e){var i={title:"Attenzione",msg:"C'Ã¨ stato un problema durante il caricamento dell'oggetto",close:!0,closeText:"Chiudi"};v.open(i),a.error(e)})},y=function(e){var i=($(".navigator"),V.width>V.height?"width":"height"),a="width"===i?"height":"width",t=$(".navigator")[i](),n=parseInt(V[a]*t/V[i]);$(".navigator").css(a,n+"px")};p.setMedia=function(e,a){if(!p.loadingMedia){if(p.showEcommerce=!1,u.open(),p.loadingMedia=!0,p.currentMedia=e?e:a?p.currentMedia+a:1,p.media=f[p.currentMedia-1],p.infoMedia=p.info||"",p.infoMedia=p.infoMedia?p.infoMedia+"<br/>"+p.media.title:p.media.title||"",!p.media)return void x(p.currentMedia-1,"setMedia");if(p.media.tile&&(p.viewer&&angular.element("#openseadragon1").html(""),p.viewer=OpenSeadragon({id:"openseadragon1",showNavigator:!0,visibilityRatio:1,constrainDuringPan:!0,zoomInButton:"osd-zoom-in",zoomOutButton:"osd-zoom-out",homeButton:"osd-home",fullPageButton:"osd-full-page",rotateLeftButton:"osd-rotate-left",rotateRightButton:"osd-rotate-right",prefixUrl:"../bower_components/openseadragon/built-openseadragon/openseadragon/images/"}),OpenSeadragon.makeAjaxRequest(p.media.tile,function(e){p.viewer.open(e.response)}),METAFAD_VIEWER_CONFIG.navigatorBlock&&(p.viewer.addHandler("open",function(e){var i,a;try{i=e.eventSource.source.Image.Size.Width,a=e.eventSource.source.Image.Size.Height}catch(t){i=e.source.substring(e.source.lastIndexOf('Width="')+7,e.source.lastIndexOf('" Height="')),a=e.source.substring(e.source.lastIndexOf('Height="')+8,e.source.lastIndexOf('"/>'))}V={width:i||e.source.substring(e.source.lastIndexOf('Width="')+7,e.source.lastIndexOf('" Height="')),height:a||e.source.substring(e.source.lastIndexOf('Height="')+8,e.source.lastIndexOf('"/>'))},setTimeout(function(){y()},1e3)}),p.viewer.addHandler("resize",function(e){setTimeout(function(){y()},1e3)}),$(".mibac_museowebfad_viewer .displayregion").attrchange({trackValues:!0,callback:function(e){if("style"==e.attributeName){var i=$(".navigator canvas").width()-parseInt(e.target.style.width),a=$(".navigator canvas").height()-parseInt(e.target.style.height),t=parseInt(e.target.style.left);(0>t||t>i)&&p.viewer.viewport.applyConstraints();var n=parseInt(e.target.style.top);(0>n||n>a)&&p.viewer.viewport.applyConstraints()}}}))),p.prev=p.currentMedia>1?!0:!1,p.next=p.currentMedia<p.tot?!0:!1,p.bodyHeight=angular.element(n.find(".body")).height(),h(),"IMAGE"===p.media.type){var t=new Image;t.addEventListener("load",function(){u.close(),i.setInitZoom(),p.loadingMedia=!1,d(i)},!1),t.src=p.media.url}else u.close(),p.loadingMedia=!1}},p.setZoom=null,i.setInitZoom=function(){if(p.setZoom=i.getInitZoom(),p.zoomSupported)n.find(".body .box-img-notile img").css("transform","none"),n.find(".body .box-img-notile img").css("zoom",p.setZoom);else{var e=n.find(".body .box-img-notile img").width();n.find(".body .box-img-notile img").css("position","absolute"),n.find(".body .box-img-notile img").css("margin-left","-"+e/2+"px"),n.find(".body .box-img-notile img").css("transform","scale("+p.setZoom+")"),n.find(".body .box-img-notile img").css("transform-origin","50% top")}n.find(".body .box-img-notile img").off("load"),n.find(".body .box-img-notile img").css("top",0),n.find(".body .box-img-notile img").css("left",""),I=!0,i.$broadcast("setDraggable:enable",I)},i.getInitZoom=function(){var e,i=null,a=null,t=n.find(".body").width(),o=n.find(".body").height(),r=n.find(".body .box-img-notile img").width(),d=n.find(".body .box-img-notile img").height();return r>t&&(i=t/r),d>o&&(a=o/d),e=i&&a?a>=i?i:a:i||a||1},p.checkZoom=function(e){p.showEcommerce=!1,"single-page"===p.view&&("in"===e?p.zoomIn():"out"===e?p.zoomOut():i.setInitZoom())};var I,E=!1;p.zoomIn=function(){if(E)return!1;if(E=!0,p.setZoom+=.1,p.zoomSupported)n.find(".body .box-img-notile img").css("zoom",p.setZoom);else{var e=n.find(".body .box-img-notile img").width();n.find(".body .box-img-notile img").css("margin-left","-"+e/2+"px"),n.find(".body .box-img-notile img").css("transform","scale("+p.setZoom+")"),n.find(".body .box-img-notile img").css("transform-origin","50% top")}!I&&p.setZoom>i.getInitZoom()&&(I=!0),setTimeout(function(){E=!1},300)},p.zoomOut=function(){if(E||p.setZoom-.1<0)return!1;if(E=!0,p.setZoom-=.1,p.zoomSupported)n.find(".body .box-img-notile img").css("zoom",p.setZoom);else{var e=n.find(".body .box-img-notile img").width();n.find(".body .box-img-notile img").css("margin-left","-"+e/2+"px"),n.find(".body .box-img-notile img").css("transform","scale("+p.setZoom+")"),n.find(".body .box-img-notile img").css("transform-origin","50% top")}I&&p.setZoom<i.getInitZoom()&&(I=!1),setTimeout(function(){E=!1},300)},p.checkRotate=function(e){("single-page"===p.view||"single-zoom"===p.view)&&(p.showEcommerce=!1,p.rotate[e]())},p.rotate={status:0,setRotate:function(e){var i=($(".box-img-notile img"),$(".box-img-notile img")[0].style.transform);i=i.replace("none",""),-1!==i.indexOf("rotate")?i=i.replace(/rotate((.*?)deg)/,"rotate("+e+"deg"):i+=" rotate("+e+"deg)",$(".box-img-notile img")[0].style.transform=i},right:function(){var e=270===p.rotate.status?0:p.rotate.status+90;return p.rotate.status=e,"single-zoom"===p.view?p.viewer.viewport.setRotation(e):void p.rotate.setRotate(e)},left:function(){var e=0===p.rotate.status?270:p.rotate.status-90;return p.rotate.status=e,"single-zoom"===p.view?p.viewer.viewport.setRotation(e):void p.rotate.setRotate(e)},init:function(){var e=0;return p.rotate.status=e,"single-zoom"===p.view?p.viewer.viewport.setRotation(e):void p.rotate.setRotate(e)}},p.panelActive=!1,p.toggleEle=function(e){return p.showEcommerce=!1,e?!1:!0},p.checkSupportedMedia=function(e){var i=["IMAGE","VIDEO","AUDIO","PDF"],a=-1!==i.indexOf(e)?!0:!1;return a},p.enableIndex=function(){var e=["single-page","single-zoom","double-page"],i=-1!==e.indexOf(p.view);return i},p.pages={showBox:!1,viewBox:function(){return p.pages.showBox?p.pages.showBox=!1:void(p.pages.showBox=!0)},range:[],goToFirst:function(){p.setMedia(1)},goToLast:function(){p.setMedia(p.tot)},goPrevious:function(){var e=1;"double-page"===p.view&&e++,p.setMedia(!1,-e)},goNext:function(){var e=1;"double-page"===p.view&&e++,p.setMedia(!1,e)},goTo:function(e){p.setMedia(e),p.pages.showBox=!1}},p.treeConfig={extensions:["glyph"],init:function(e,i){var a=i.tree.getNodeByKey("exclude");a&&a.remove()},activate:function(e,i){p.loadEleFolder(i.node)},glyph:{map:{doc:"icon-vw-folder",docOpen:"fa fa-folder-open-o",checkbox:"fa fa-unchecked",checkboxSelected:"fa fa-check",checkboxUnknown:"fa fa-share",dropMarker:"fa fa-arrow-right",expanderClosed:"fa fa-caret-right",expanderOpen:"fa fa-caret-down",folder:"icon-vw-folder",folderOpen:"fa fa-folder-open-o"}}},p.folderActive=null,p.loadEleFolder=function(e){var a=_.findIndex(p.medias,function(i,a){return i.keyNode==e.key||i.aliasKeyNode==e.key||i.aliasKeyNode&&-1!==i.aliasKeyNode.indexOf(e.key)});p.pages.goTo(a+1),p.folderActive=e,d(i)},p.lazyOptions={offset:0};var C=0;p.lazyLoaded=!1;var A=i.$on("lazyImg:loaded",function(e,i){C++,C===p.medias.length&&(p.lazyLoaded=!0)});p.range=o("range")(p.pages.range,p.tot);var k=$(window).on("resize.doResize",function(){i.setInitZoom()});w(),i.$on("destroy",function(){A(),M(),b(),k()})}i.$inject=["$rootScope","$scope","$log","$sce","$element","$filter","$timeout","refreshAngularCircle","DamCollectionManagerService","viewerFactory","MainService","mergeArrayUnique","serviceUUID","LoadingService","$uiMrFeedback"],angular.module("metaMediaViewerModule",[]).directive("metaMediaViewerDirective",e).directive("lazyImg",function(){return{restrict:"A",link:function(e,i,a){return a.$observe("afklLazyImageLoaded",function(i){console.log(i),e.$emit("lazyImg:loaded",i)})}}}).directive("paginationComponent",function(){return{restrict:"E",templateUrl:"app/components/metaMediaViewerCustom/pagination.html",replace:!0}}).service("LoadingService",[function(){var e=this;this.loader=null,this.open=function(i,a,t){var n,o=a?'<div class="custom-message">'+a+"</div>":"",r={"default":'<div id="loadingService-custom-loader" class="custom-loader">'+o+'<div class="custom-spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>',pace:'<div id="loadingService-custom-loader" class="custom-loader-pace"><div class="custom-pace"></div>'+o+"</div>"},d=r[t]||r["default"];if(i)n=i,e.loader="#loadingService-custom-loader";else{var s=angular.element("#loadingService-block-layer-loading");if(s.length)return!1;var c=t||"";d='<div id="loadingService-block-layer-loading" class="block-layer-loading '+c+'">'+d+"</div>",e.loader="#loadingService-block-layer-loading",n=angular.element("body")}n.append(d)},this.close=function(){e.loader&&angular.element(e.loader).remove()}}])}(),function(){"use strict";angular.module("damCollectionManagerMdl",[])}(),function(){"use strict";function e(e,i,a){var t=this,n=[];t.refresh=function(){n=[]},t.initTree=function(i,a,t,o,r){n.push({instance:i,source:t}),o&&e.$broadcast("damCollectionManagerInitTree",i,a,t,r)},t.setTreeConfigPart=function(i,a,t){t&&e.$broadcast("damCollectionManagerSetTreeConfigPart",i,a)},t.setTreeConfig=function(i,a,t,o){var r=_.findIndex(n,{instance:i});-1!==r&&(a.source=n[r].source),t&&e.$broadcast("damCollectionManagerSetTreeConfig",i,a,o)},t.setTree=function(i,a,t,o){var r=_.findIndex(n,{instance:i});-1!==r?n[r].source=a:n.push({instance:i,source:a}),t&&e.$broadcast("damCollectionManagerSetTree",i,a,o)};var o=function(e){var i=e.getParentList(),a="";return _.forEach(i,function(e){a+=e.title+"/"}),a+=e.title};t.setActiveNode=function(i,t,r){var d=_.findIndex(n,{instance:i});if(-1!==d){n[d].activeNode=t;var s=o(t);n[d].activePath=s}else a.info("Instance tree not exist");r&&e.$broadcast("damCollectionManagerSetActiveNode",i,t)},t.refreshActiveNode=function(i,t){var o=_.findIndex(n,{instance:i});-1!==o?(n[o].activeNode=null,n[o].activePath=null):a.info("Instance tree not exist"),t&&e.$broadcast("damCollectionManagerRefreshActiveNode",i)},t.getActiveNode=function(e){var i=_.findIndex(n,{instance:e});return-1!==i?n[i].activeNode:(a.info("Instance tree not exist"),null)},t.getActivePath=function(e){var i=_.findIndex(n,{instance:e});return-1!==i?n[i].activePath:(a.info("Instance tree not exist"),null)},t.setExpandNode=function(i,t,o,r){var d=_.findIndex(n,{instance:i});return-1===d?(a.info("Instance tree not exist"),null):(n[d].expandNode=t,void(r&&e.$broadcast("damCollectionManagerSetExpandNode",i,o)))},t.addExpandNode=function(i,t,o,r){var d=_.findIndex(n,{instance:i});return-1===d?(a.info("Instance tree not exist"),null):(n[d].expandNode||(n[d].expandNode=[]),n[d].expandNode.push(t),void(r&&e.$broadcast("damCollectionManagerAddExpandNode",i,t,o)))},t.getExpandNode=function(e){var i=_.findIndex(n,{instance:e});return-1!==i?n[i].expandNode:(a.info("Instance tree not exist"),null)},t.setSelectedNode=function(i,t,o,r){var d=_.findIndex(n,{instance:i});return-1===d?(a.info("Instance tree not exist"),null):(n[d].selectedNode=t,void(r&&e.$broadcast("damCollectionManagerSetSelectedNode",i,o)))},t.addSelectedNode=function(i,t,o,r){var d=_.findIndex(n,{instance:i});return-1===d?(a.info("Instance tree not exist"),null):(n[d].selectedNode||(n[d].selectedNode=[]),n[d].selectedNode.push(t),void(r&&e.$broadcast("damCollectionManagerAddSelectedNode",i,t,o)))},t.removeSelectedNode=function(i,t,o,r){var d=_.findIndex(n,{instance:i});if(-1===d)return a.info("Instance tree not exist"),null;var s=angular.isObject(t)?_.findIndex(n[d].selectedNode,t):_.indexOf(n[d].selectedNode,t);return-1===s?(a.info("Node not exist"),null):(n[d].selectedNode.splice(s,1),void(r&&e.$broadcast("damCollectionManagerRemoveSelectedNode",i,t,o)))},t.getSelectedNode=function(e){var i=_.findIndex(n,{instance:e});return-1!==i?n[i].selectedNode:(a.info("Instance tree not exist"),null)}}e.$inject=["$rootScope","$timeout","$log"],angular.module("damCollectionManagerMdl").service("DamCollectionManagerService",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"app/components/damCollectionManager/damCollectionManager.html",scope:{instance:"@datainstance",treeConfig:"=treeConfig"},controller:i,controllerAs:"damColMng",bindToController:!0};return e}function i(e,i,a,t,n,o){function r(e,i){var a=[],t=1;_.forEach(e,function(e){var i={id:e.id,title:e.title,key:e.id||t,folder:!0,lazy:e.hasChild};a.push(i)}),i(a)}function d(e,i){var a=[],t=1;_.forEach(e,function(e){var i=e.label.split("/"),n=a;_.forEach(i,function(e){var i=_.find(n,{title:e});if(i)n=i.children;else if(e&&""!=e){var a={title:e,key:t,folder:!0,children:[]};n.push(a),n=a.children,t++}})}),i(a)}var s=this,c=function(){},l=null,m=function(e,i){var t=angular.element('<div class="fancyTreeInstance"></div>');i.instance=e,l=t.fancytree(i),a.html(t)},g=i.$on("damCollectionManagerInitTree",function(e,i,a,t,n){if(i===s.instance){s.treeConfig=a,n?v[n](t,function(e){s.treeConfig.source=e}):s.treeConfig.source=t,m(i,s.treeConfig);var r=o.getExpandNode(s.instance);_.forEach(r,function(e){"path"===n&&h(e)})}}),u=i.$on("damCollectionManagerSetTreeConfigPart",function(e,i,t){if(i===s.instance){var n=a.find(".fancyTreeInstance")[0];_.forEach(t,function(e){s.treeConfig[e.key]=e.value,$(n).fancytree("option",e.key,e.value)})}}),v={path:d,objLazy:r},f=i.$on("damCollectionManagerSetActiveNode",function(e,i,a){i===s.instance&&p(a)}),p=function(e){var i=a.find(".fancyTreeInstance")[0],t=$(i).fancytree("getRootNode");t.tree.activateKey(e.key)},w=i.$on("damCollectionManagerRefreshActiveNode",function(e,i){if(i===s.instance){var t=a.find(".fancyTreeInstance")[0],n=$(t).fancytree("getRootNode"),o=n.tree.getActiveNode();o&&(o.setFocus(!1),o.setActive(!1))}}),M=i.$on("damCollectionManagerSetExpandNode",function(e,i,a){if(i===s.instance){var t=o.getActiveNode();"path"===a&&h(t)}}),b=i.$on("damCollectionManagerAddExpandNode",function(e,i,a,t){i===s.instance&&("path"===t?h(a):"id"===t&&V(a))}),h=function(e){var i=a.find(".fancyTreeInstance")[0],t=$(i).fancytree("getRootNode");t&&(e=e.split("/"),_.forEach(e,function(e){t=t&&t.findFirst(e),t&&t.setExpanded(!0)}))},V=function(e){var i=a.find(".fancyTreeInstance")[0],n=$(i).fancytree("getRootNode"),o=n.tree&&n.tree.getNodeByKey(e);if(o){o.lazy===!1&&(o.lazy=!0);var r=o.isExpanded();r&&o.resetLazy(),t(function(){o.setExpanded(!0)},300)}},x=i.$on("damCollectionManagerAddSelectedNode",function(e,i,a,t){i===s.instance&&"id"===t&&y(a)}),y=function(e){var i=a.find(".fancyTreeInstance")[0],t=$(i).fancytree("getRootNode"),n=t.tree&&t.tree.getNodeByKey(e);n&&n.setSelected(!0)},I=i.$on("damCollectionManagerRemoveSelectedNode",function(e,i,a,t){i===s.instance&&"id"===t&&E(a)}),E=function(e){var i=a.find(".fancyTreeInstance")[0],t=$(i).fancytree("getRootNode"),n=t.tree&&t.tree.getNodeByKey(e);n&&n.setSelected(!1)};e.$emit(s.instance+"ManagerReady",s.instance+"Manager"),e.$on("$stateChangeStart",function(){g(),u(),f(),M(),b(),x(),I(),w(),o.refresh()}),c()}i.$inject=["$scope","$rootScope","$element","$timeout","$log","DamCollectionManagerService"],angular.module("damCollectionManagerMdl").directive("damCollectionManager",e)}(),function(){"use strict";angular.module("metaViewerFe",["ngAnimate","ngTouch","ngSanitize","ngMessages","ngAria","ngResource","ui.router","utilsMdl","metaMediaViewerModule","damCollectionManagerMdl","afkl.lazyImage","dc.endlessScroll","720kb.tooltips","truncate","nsPopover","metaMediaViewerMdl","mrFeedbackMdl"])}(),function(){"use strict";function e(e,i,a){return{getMetadatoMock:function(t,n,o,r){var d=e.defer();return a.serviceProvider.get({resource1:"metadato",element1:t,init:n,num:o,type:r},{},function(e){var i=!0;e.physicalSTRU.tot=e.physicalSTRU.image.length,i&&(_.forEach(e.physicalSTRU.image,function(e,i){e.id=i+1e3}),i=!1);var a=n+o<e.physicalSTRU.image.length?o:e.physicalSTRU.image.length-n;e.physicalSTRU.image=e.physicalSTRU.image.splice(n,a),d.resolve(e)},function(e){var a=e.data&&e.data.message?e.data.message:"Server non raggiungibile";i.error(a),d.reject(a)}),d.promise},getMediaMock:function(t,n){var o=e.defer();return a.serviceProvider.get({resource1:"strumag",element1:t},{},function(e){var i=e.physicalSTRU.image[n],a={id:i.id,thumbnail:i.thumbnail,title:i.title,type:i.type,url:i.src,tile:i.tile,keyNode:i.keyNode,aliasKeyNode:value.aliasKeyNode,label:i.label};o.resolve(a)},function(e){var a=e.data&&e.data.message?e.data.message:"Server non raggiungibile";i.error(a),o.reject(a)}),o.promise},getMetadato:function(t,n,o,r,d,s){var c=e.defer();return n&&(n=encodeURI(n)),a.serviceProvider.get({resource1:"metadato",element1:t,id:n,init:o,num:r,type:d,folder:s},{},function(e){e.physicalSTRU.tot||(e.physicalSTRU.tot=e.physicalSTRU.image.length),c.resolve(e)},function(e){var a=e.data&&e.data.message?e.data.message:"Server non raggiungibile";i.error(a),c.reject(a)}),c.promise},getMedia:function(t,n){var o=e.defer();return a.serviceProvider.get({resource1:"strumag",element1:t},{},function(e){var i=e.physicalSTRU.image[n];o.resolve(i)},function(e){var a=e.data&&e.data.message?e.data.message:"Server non raggiungibile";i.error(a),o.reject(a)}),o.promise}}}e.$inject=["$q","$log","MainService"],angular.module("metaViewerFe").factory("viewerFactory",e)}(),function(){"use strict";function e(e,i,a,t,n,o,r,d,s,c,l){var m=this,g=0,u=function(){var e=f(r);m.MetaMediaViewer.medias=[],m.MetaMediaViewer.index=e.index,m.MetaMediaViewer.info=e.info,m.MetaMediaViewer.medias=m.MetaMediaViewer.medias.concat(e.medias),m.MetaMediaViewer.tot=e.tot,m.MetaMediaViewer.itemInPage=e.itemInPage,m.MetaMediaViewer.mediasGrid=e.medias.length>e.itemInPage?_.clone(e.medias).slice(0,e.itemInPage):_.clone(e.medias),m.MetaMediaViewer.title=e.title,m.MetaMediaViewer.show=!0,g+=m.MetaMediaViewer.mediasGrid.length},v=$(window).on("resize.doResize",function(){t.$apply(function(){m.MetaMediaViewer.options.height=o.getAppHeight()+"px"})});m.MetaMediaViewer={show:!1,options:{modal:!1,theme:"light",height:o.getAppHeight()+"px"},medias:[]};var f=function(e){var i={};return i.title=e.title,i.index=e.logicalSTRU,i.info=e.info,i.medias=[],_.forEach(e.physicalSTRU.image,function(e){var a={id:e.id||s.create(),thumbnail:e.thumbnail,title:e.title,type:e.type.toUpperCase(),url:e.src||e.url,tile:e.tile,keyNode:e.keyNode,aliasKeyNode:e.aliasKeyNode,label:e.label};i.medias.push(a)}),i.tot=e.physicalSTRU.tot,i.totFolder=e.physicalSTRU.totFolder,i.itemInPage=o.getItemInPage(),i},p=function(e,a,t,r){var d,s,r=o.typeMetadato,c=a||g;"query"===METAFAD_VIEWER_CONFIG.idType?(d="",s=o.metadato):(d=o.metadato,s=null),n.getMetadato(d,s,e,c,r,t).then(function(e){var i=f(e);r?m.MetaMediaViewer[r]=i.medias:m.MetaMediaViewer.medias=i.medias,m.MetaMediaViewer.tot=i.tot,g=m.MetaMediaViewer.itemInPage},function(e){var a={title:"Attenzione",msg:"C'Ã¨ stato un problema durante il caricamento dell'oggetto",close:!0,closeText:"Chiudi"};l.open(a),i.error(e)})},w=t.$on("metaMediaViewer:getMetadato",function(e,i,a,t,n){p(i,a,t)}),M=!1,b=function(e,a){if(!M){M=!0;var r,d,s=o.typeMetadato;"query"===METAFAD_VIEWER_CONFIG.idType?(r="",d=o.metadato):(r=o.metadato,d=null),n.getMetadato(r,d,g,m.MetaMediaViewer.itemInPage,s,e).then(function(e){var i=f(e);a?m.MetaMediaViewer[a]=m.MetaMediaViewer[a].concat(i.medias):m.MetaMediaViewer.medias=m.MetaMediaViewer.medias.concat(i.medias),m.MetaMediaViewer.tot=i.tot,g+=m.MetaMediaViewer.itemInPage,M=!1,t.$broadcast("viewer:loaded:nextPage")},function(e){var a={title:"Attenzione",msg:"C'Ã¨ stato un problema durante il caricamento dell'oggetto",close:!0,closeText:"Chiudi"};l.open(a),i.error(e),M=!1,t.$broadcast("viewer:loaded:nextPage")})}},h=t.$on("metaMediaViewer:nextPage",function(e,i,a){b(i,a)}),V=a.innerWidth,x=e.$on("checkEndResize",function(){var e=a.innerWidth-20,i=METAFAD_VIEWER_CONFIG.viewerHeight-58,t=d(e,i,170,216);o.setItemInPage(t),a.innerWidth>V&&(b(),V=a.innerWidth)});u(),t.$on("destroy",function(){v(),x(),w(),h()})}e.$inject=["$rootScope","$log","$window","$scope","viewerFactory","MainService","objMetadato","detectItemInPage","serviceUUID","LoadingService","$uiMrFeedback"],angular.module("metaViewerFe").controller("ViewerController",e)}(),function(){"use strict";function e(e,i){var a=this;a.serviceProvider=e(METAFAD_VIEWER_CONFIG.serverRoot+"/:service/:resource1/:element1",{service:"@service",resource1:"@resource1",element1:"@element1"},{get:{method:"GET",cache:!1},getArray:{method:"GET",cache:!1,withCredentials:!0,isArray:!0}}),a.getAppHeight=function(){var e;if(METAFAD_VIEWER_CONFIG.externalHeight)e=METAFAD_VIEWER_CONFIG.viewerHeigh;else{var a=angular.element(".viewer")[0].getBoundingClientRect().top;e=i.innerHeight-a}return e};var t=24;a.setItemInPage=function(e){t=e},a.getItemInPage=function(){return t}}e.$inject=["$resource","$window"],angular.module("metaViewerFe").service("MainService",e)}(),function(){"use strict";function e(e){var i=function(){e.go("main.viewer")};i()}e.$inject=["$state"],angular.module("metaViewerFe").controller("MainController",e)}(),function(){"use strict";function e(e){e.debug("runBlock end")}e.$inject=["$log"],angular.module("metaViewerFe").run(e)}(),function(){"use strict";function e(e,i){e.state("main",{url:"/main",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}).state("main.viewer",{url:"/viewer?idMetadato&type",templateUrl:"app/viewer/viewer.html",controller:"ViewerController",controllerAs:"viewer",resolve:{objMetadato:["$q","$log","$window","$stateParams","viewerFactory","detectItemInPage","MainService","$uiMrFeedback",function(e,i,a,t,n,o,r,d){var s=a.innerWidth-20,c=METAFAD_VIEWER_CONFIG.viewerHeight-58,l=o(s,c,170,216);r.setItemInPage(l),r.metadato=t.idMetadato,r.typeMetadato=t.type;var m=e.defer();t.idMetadato||m.reject("Missing 'idMetadato' or 'type'");var g,u;return"query"===METAFAD_VIEWER_CONFIG.idType?(g="",u=t.idMetadato):(g=t.idMetadato,u=null),n.getMetadato(g,u,0,null,t.type).then(function(e){m.resolve(e)},function(e){var a={title:"Attenzione",msg:"C'Ã¨ stato un problema durante il caricamento dell'oggetto",close:!0,closeText:"Chiudi"};d.open(a),i.error(e),m.reject(e)}),m.promise}]}}),i.otherwise("/main")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("metaViewerFe").config(e)}(),function(){"use strict";angular.module("metaViewerFe")}(),function(){"use strict";function e(e,i){e.debugEnabled(!0),i.defaultTheme="facebook"}e.$inject=["$logProvider","mrFeedbackConfigProvider"],angular.module("metaViewerFe").config(e)}(),function(){"use strict";angular.module("utilsMdl",[]).factory("refreshAngularCircle",function(){return function(e){"$apply"!=e.$root.$$phase&&"$digest"!=e.$root.$$phase&&e.$apply()}}).factory("detectItemInPage",function(){return function(e,i,a,t){var n=parseInt(e/a),o=parseInt(i/t)+1,r=n*o;return r}}).filter("range",function(){return function(e,i){i=parseInt(i);for(var a=0;i>a;a++)e.push(a);return e}}).factory("mergeArrayUnique",function(){return function(e){for(var i=e.concat(),a=0;a<i.length;++a)for(var t=a+1;t<i.length;++t)i[a]===i[t]&&i.splice(t--,1);return i}}).directive("detectScrollEnd",["$rootScope",function(e){return{restrict:"A",link:function(i,a){var t,n=a[0],o=!1;a.bind("scroll",function(){t&&n.scrollTop<t||(t=n.scrollTop,n.scrollTop+n.offsetHeight+(n.clientHeight-100)>=n.scrollHeight&&(o||(o=!0,e.$broadcast("detectScrollEnd:bottom"),setTimeout(function(){o=!1},700))))})}}}]).directive("checkEndResize",["$rootScope",function(e){return{restrict:"A",link:function(i){function a(){new Date-t<o?setTimeout(a,o):(n=!1,e.$broadcast("checkEndResize"))}var t,n=!1,o=200;$(window).resize(function(){t=new Date,n===!1&&(n=!0,setTimeout(a,o))})}}}]).service("serviceUUID",function(){this.create=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return e=e.replace(/[xy]/g,function(e){var i=16*Math.random()|0,a="x"==e?i:3&i|8;return a.toString(16)})}}).directive("ngRightClick",["$parse",function(e){return function(i,a,t){var n=e(t.ngRightClick);a.bind("contextmenu",function(e){i.$apply(function(){e.preventDefault(),n&&n(i,{$event:e})})})}}]).directive("setDraggable",["$document",function(e){return function(i,a){function t(e){f=(e.clientY-d)/u,v=(e.clientX-r)/u,o(),l&&l(e)}function n(i){e.unbind("mousemove",t),e.unbind("mouseup",n),c&&c(i)}function o(){g&&(m&&(v<m.left?v=m.left:v>m.right-p&&(v=m.right-p),f<m.top?f=m.top:f>m.bottom-w&&(f=m.bottom-w)),a.css({top:f+"px",left:v+"px"}))}var r,d,s,c,l,m,g,u,v=0,f=0,p=a[0].offsetWidth,w=a[0].offsetHeight;if(i.dragOptions){s=i.dragOptions.start,l=i.dragOptions.drag,c=i.dragOptions.stop;var M=i.dragOptions.container;M&&(m=document.getElementById(M).getBoundingClientRect())}a.css({position:"relative"}),a.on("mousedown",function(i){i.preventDefault(),u=a[0].style.zoom?parseFloat(a[0].style.zoom):0,r=i.clientX,d=i.clientY,e.on("mousemove",t),e.on("mouseup",n),s&&s(i)}),i.$on("setDraggable:enable",function(e,i){g=i,g?a.css({cursor:"move"}):a.css({cursor:"auto"})})}}])}(),angular.module("metaViewerFe").run(["$templateCache",function(e){e.put("app/main/main.html",'<div><div ui-view=""></div></div>'),e.put("app/viewer/viewer.html",'<div class="mibac_museowebfad_viewer viewer" check-end-resize=""><meta-media-viewer-directive medias="viewer.MetaMediaViewer.medias" medias-grid="viewer.MetaMediaViewer.mediasGrid" index="viewer.MetaMediaViewer.index" title-metadato="viewer.MetaMediaViewer.title" tot="viewer.MetaMediaViewer.tot" totfolder="viewer.MetaMediaViewer.totFolder" item-in-page="viewer.MetaMediaViewer.itemInPage" info="viewer.MetaMediaViewer.info" options="viewer.MetaMediaViewer.options" ng-if="viewer.MetaMediaViewer.show"></meta-media-viewer-directive></div>'),e.put("app/components/damCollectionManager/damCollectionManager.html",""),e.put("app/components/metaMediaViewerCustom/metaMediaViewer.html",'<div class="contentMetaMediaViewer"><div class="metaMediaViewer modal-preview animate-modal-preview {{metaMediaViewer.options.customClass}} {{metaMediaViewer.options.theme}} {{metaMediaViewer.modalMode ? \'modal-mode\' : \'\'}}" style="height:{{metaMediaViewer.contentHeight}}"><div class="box-numNav" ng-if="metaMediaViewer.totalMedias>1"></div><div class="header noselect"><div class="box-btnHeader box-btnHeader-left"><a class="btn-indice btnHeader {{metaMediaViewer.btnOptions.index}}" ng-class="{\'active\':metaMediaViewer.indexActive, \'disabled\':!metaMediaViewer.index}" ng-click="metaMediaViewer.indexActive= metaMediaViewer.index && metaMediaViewer.toggleEle(metaMediaViewer.indexActive)" ng-show="metaMediaViewer.enableIndex()"><span class="icon-vw-list"></span></a> <a class="separator {{metaMediaViewer.btnOptions.separatorIndex}}" ng-if="metaMediaViewer.index"></a> <a class="btn-info btnHeader {{metaMediaViewer.btnOptions.info}}" ng-class="{\'active\':metaMediaViewer.infoActive, \'disabled\':!metaMediaViewer.infoMedia}" ng-click="metaMediaViewer.infoActive=metaMediaViewer.infoMedia && metaMediaViewer.toggleEle(metaMediaViewer.infoActive)"><span class="icon-vw-info-circle"></span></a> <a class="btn-text btnHeader disabled {{metaMediaViewer.btnOptions.text}}" ng-show="metaMediaViewer.view===\'single-page\' || metaMediaViewer.view===\'single-zoom\'"><span class="icon-vw-text"></span></a> <a class="btn-text-search btnHeader disabled {{metaMediaViewer.btnOptions.text_search}}"><span class="icon-vw-file-view"></span></a> <a class="btn-download btnHeader disabled {{metaMediaViewer.btnOptions.download}}" ng-show="metaMediaViewer.view===\'single-page\' || metaMediaViewer.view===\'single-zoom\'" href=""><span class="icon-vw-download"></span></a> <a class="btn-shop btnHeader" ng-click="metaMediaViewer.manageEcommerce()" ng-class="{\'active\':metaMediaViewer.showEcommerce}" ng-show="metaMediaViewer.showBtnEcommerce && (metaMediaViewer.view===\'single-page\' || metaMediaViewer.view===\'single-zoom\')"><span class="icon-vw-shopping-cart"></span></a> <a class="separator {{metaMediaViewer.btnOptions.separatorActions}}"></a> <a class="btn-list-grid btnHeader" ng-if="!metaMediaViewer.singleMetadato" ng-class="{\'active\':metaMediaViewer.view===\'grid\'}" ng-click="metaMediaViewer.setView(\'grid\')"><span class="icon-vw-th"></span></a> <a class="btn-list-single btnHeader {{metaMediaViewer.btnOptions.single}}" ng-class="{\'active\':metaMediaViewer.view===\'single-page\'}" ng-click="metaMediaViewer.setView(\'single-page\')"><span class="icon-vw-file"></span></a> <a class="btn-list-singleZoom btnHeader {{metaMediaViewer.btnOptions.singleZoom}}" ng-class="{\'active\':metaMediaViewer.view===\'single-zoom\'}" ng-click="metaMediaViewer.setView(\'single-zoom\')" ng-if="metaMediaViewer.media.tile"><span class="icon-vw-file-view-simple"></span></a> <a class="btn-list-double btnHeader {{metaMediaViewer.btnOptions.double}}" ng-class="{\'active\':metaMediaViewer.view===\'double-page\'}" ng-click="metaMediaViewer.setView(\'double-page\')" ng-if="!metaMediaViewer.singleMetadato"><span class="icon-vw-double-page"></span></a> <a class="btn-list-rullo btnHeader {{metaMediaViewer.btnOptions.rullo}}" ng-class="{\'active\':metaMediaViewer.view===\'rullo\'}" ng-click="metaMediaViewer.setView(\'rullo\')" ng-if="!metaMediaViewer.singleMetadato"><span class="icon-vw-vertical-page"></span></a> <a class="separator {{metaMediaViewer.btnOptions.separatorViews}}"></a> <a class="btn-social btnHeader disabled {{metaMediaViewer.btnOptions.social}}"><span class="icon-vw-share"></span></a> <a class="separator {{metaMediaViewer.btnOptions.separatorSocial}}"></a></div><div class="box-btnHeader box-btnHeader-center"><div class="content-pagination-header" ng-if="metaMediaViewer.pagination.position===\'header\'" ng-class="{\'content-pagination-double\': metaMediaViewer.view===\'double-page\'}"><pagination-component></pagination-component></div></div><div class="box-btnHeader box-btnHeader-right" ng-show="metaMediaViewer.media.type === \'IMAGE\' && metaMediaViewer.view===\'single-page\'"><a class="btn-zoom btnHeader" ng-click="metaMediaViewer.checkZoom(\'out\')"><span class="icon-vw-search-minus"></span></a> <a class="btn-home btnHeader" ng-click="metaMediaViewer.checkZoom(\'home\');metaMediaViewer.rotate.init();"><i class="fa fa-square-o"></i></a> <a class="btn-zoom btnHeader" ng-click="metaMediaViewer.checkZoom(\'in\')"><span class="icon-vw-search-plus"></span></a> <a class="separator"></a> <a class="btn-rotate btnHeader" ng-click="metaMediaViewer.checkRotate(\'left\')" ng-show="metaMediaViewer.zoomSupported"><span class="icon-vw-undo"></span></a> <a class="btn-rotate btnHeader" ng-click="metaMediaViewer.checkRotate(\'right\')" ng-show="metaMediaViewer.zoomSupported"><i class="icon-vw-rotate-right"></i></a></div><div class="box-btnHeader box-btnHeader-right" ng-show="metaMediaViewer.view===\'single-zoom\'"><a class="btn-zoom btnHeader" id="osd-zoom-out"><span class="icon-vw-search-minus"></span></a> <a class="btn-home btnHeader" id="osd-home" ng-click="metaMediaViewer.rotate.init();"><i class="fa fa-square-o"></i></a> <a class="btn-modal btnHeader" id="osd-full-page"><i class="icon-vw-expand" ng-if="!metaMediaViewer.modalMode"></i> <i class="fa fa-compress" ng-if="metaMediaViewer.modalMode"></i></a> <a class="btn-zoom btnHeader" id="osd-zoom-in"><span class="icon-vw-search-plus"></span></a> <a class="separator"></a> <a class="btn-rotate btnHeader" id="osd-rotate-left" ng-click="metaMediaViewer.checkRotate(\'left\')"><span class="icon-vw-undo"></span></a> <a class="btn-rotate btnHeader" id="osd-rotate-right" ng-click="metaMediaViewer.checkRotate(\'right\')"><i class="icon-vw-rotate-right"></i></a></div><div class="btn-close" ng-if="metaMediaViewer.options.btnClose" ng-click="metaMediaViewer.close()"><span class="fa fa-times"></span></div></div><div class="panel-left"><div class="box-index" ng-show="metaMediaViewer.indexActive && metaMediaViewer.enableIndex()"><dam-collection-manager datainstance="viewerIndex" tree-config="metaMediaViewer.treeConfig"></dam-collection-manager></div><div class="box-info" ng-show="metaMediaViewer.infoActive" ng-bind-html="metaMediaViewer.infoMedia"></div></div><div class="body" ng-class="{\'index-info-active\':metaMediaViewer.indexActive && metaMediaViewer.infoActive, \'info-active\':metaMediaViewer.infoActive, \'index-active\':metaMediaViewer.indexActive}" style="{{metaMediaViewer.bodyStyle}}"><div class="content-view content-grid" ng-if="metaMediaViewer.view===\'grid\'" detect-scroll-end=""><div class="box-grid-page" ng-repeat="media in metaMediaViewer.mediasGrid track by $index" ng-click="metaMediaViewer.loadSingleMedia($index)"><div class="img-middle-responsive"><div class="responsive-container"><div class="dummy"></div><div class="img-container"><div class="centerer"></div><img alt="{{media.label || media.title}}" title="{{media.label || media.title}}" ng-src="{{media.thumbnail}}" ng-right-click=""></div></div></div><div class="box-grid-title" tooltips="" tooltip-template="{{media.label || media.title}}">{{media.label || media.title}}</div></div><div class="custom-loader" ng-if="metaMediaViewer.showLoading"><div class="custom-spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div><div class="content-view content-single-page" ng-show="metaMediaViewer.view===\'single-page\' || metaMediaViewer.view===\'single-zoom\'" ng-right-click=""><div class="box-none" ng-if="metaMediaViewer.media.type && !metaMediaViewer.checkSupportedMedia(metaMediaViewer.media.type)"><h3>Tipo di media non supportato</h3></div><div class="box-media" ng-show="metaMediaViewer.media.type===\'IMAGE\'"><div class="box-img" id="openseadragon1" ng-show="metaMediaViewer.view===\'single-zoom\'"></div><div class="box-img-notile" style="height:{{metaMediaViewer.bodyHeight}}px" ng-show="metaMediaViewer.view===\'single-page\'" ng-class="{\'invisible\':metaMediaViewer.loadingMedia}"><img alt="{{metaMediaViewer.media.label || metaMediaViewer.media.title}}" title="{{metaMediaViewer.media.label || metaMediaViewer.media.title}}" ng-class="{\'draggable\':metaMediaViewer.setZoom>1}" set-draggable="" ng-src="{{metaMediaViewer.media.url}}" class="rotate_{{metaMediaViewer.rotate.status}}"></div></div><div class="box-media" ng-if="metaMediaViewer.media.type===\'AUDIO\' || metaMediaViewer.media.type===\'VIDEO\'"><div class="box-multimedia" ng-class="{\'invisible\':metaMediaViewer.loadingMedia}"><meta-media-viewer medias="[metaMediaViewer.media]" options="metaMediaViewer.mediaViewerOptions"></meta-media-viewer></div></div></div><div class="content-view content-double-page" ng-if="metaMediaViewer.view===\'double-page\'" ng-right-click=""><div class="box-double-img img-container-left"><div class="img-middle-responsive"><div class="responsive-container" style="height:{{metaMediaViewer.bodyHeight}}px"><div class="dummy"></div><div class="img-container"><div class="centerer"></div><img ng-if="metaMediaViewer.doubleMedia[0].type===\'IMAGE\'" alt="{{metaMediaViewer.doubleMedia[0].label || metaMediaViewer.doubleMedia[0].title}}" title="{{metaMediaViewer.doubleMedia[0].label || metaMediaViewer.doubleMedia[0].title}}" ng-src="{{metaMediaViewer.doubleMedia[0].url}}"><div class="mmv-container"><meta-media-viewer ng-if="metaMediaViewer.doubleMedia[0].type===\'AUDIO\' || metaMediaViewer.doubleMedia[0].type===\'VIDEO\'" medias="[metaMediaViewer.doubleMedia[0]]" options="metaMediaViewer.mediaViewerOptions"></meta-media-viewer></div></div></div></div></div><div class="box-double-img img-container-right"><div class="img-middle-responsive"><div class="responsive-container" style="height:{{metaMediaViewer.bodyHeight}}px"><div class="dummy"></div><div class="img-container"><div class="centerer"></div><img ng-if="metaMediaViewer.doubleMedia[1].type===\'IMAGE\'" alt="{{metaMediaViewer.doubleMedia[1].label || metaMediaViewer.doubleMedia[1].title}}" title="{{metaMediaViewer.doubleMedia[1].label || metaMediaViewer.doubleMedia[1].title}}" ng-src="{{metaMediaViewer.doubleMedia[1].url}}"><div class="mmv-container"><meta-media-viewer ng-if="metaMediaViewer.doubleMedia[1].type===\'AUDIO\' || metaMediaViewer.doubleMedia[1].type===\'VIDEO\'" medias="[metaMediaViewer.doubleMedia[1]]" options="metaMediaViewer.mediaViewerOptions"></meta-media-viewer></div></div></div></div></div></div><div class="content-view content-rullo" afkl-image-container="" ng-if="metaMediaViewer.view===\'rullo\'" ng-right-click=""><div ng-repeat="media in metaMediaViewer.medias"><div lazy-img="" afkl-lazy-image="{{media.url}}" afkl-lazy-image-options="metaMediaViewer.lazyOptions" class="box-rullo-img"></div></div><div class="lazy-space"></div></div><div class="content-pagination" ng-if="!metaMediaViewer.pagination.position || metaMediaViewer.paginationPosition===\'footer\'" ng-class="{\'content-pagination-double\': metaMediaViewer.view===\'double-page\'}"><pagination-component></pagination-component></div></div></div><div class="content-modal-ecommerce" ng-if="metaMediaViewer.showEcommerce"><iframe frameborder="0" src="{{metaMediaViewer.iframeEcommerceUrl}}"></iframe></div></div>'),
e.put("app/components/metaMediaViewerCustom/pagination.html",'<div class="block-pagination" ng-show="metaMediaViewer.view===\'single-page\' || metaMediaViewer.view===\'single-zoom\' || metaMediaViewer.view===\'double-page\'" ng-if="!metaMediaViewer.singleMetadato"><div class="box-pages" ng-if="metaMediaViewer.pages.showBox"><div class="box-page" ng-repeat="media in metaMediaViewer.medias" ng-click="metaMediaViewer.pages.goTo($index+1)"><span>{{media.label || "pag. " + ($index+1)}}</span></div></div><div class="box-pagination"><div class="box-inline btn-nav btn-first" ng-click="metaMediaViewer.pages.goToFirst()" ng-class="{\'disabled\':metaMediaViewer.loadingMedia}"><i class="icon-vw-angle-double-left"></i></div><div class="box-inline btn-nav btn-previous" ng-class="{\'not-visible\': !metaMediaViewer.prev, \'disabled\':metaMediaViewer.loadingMedia}" ng-click="metaMediaViewer.pages.goPrevious()"><i class="icon-vw-angle-left"></i></div><div class="box-inline box-current-page" ng-click="metaMediaViewer.pages.viewBox()" ng-class="{\'box-current-page-double\': metaMediaViewer.view===\'double-page\'}"><span class="label-current-page">{{metaMediaViewer.media.label || "pag. " + metaMediaViewer.currentMedia}}</span> <span class="label-current-page" ng-if="metaMediaViewer.view===\'double-page\'">{{metaMediaViewer.doubleMedia[1].label || "pag. " + metaMediaViewer.currentMedia+1}}</span> <span class="icon-arrow fa" ng-class="{ \'icon-vw-arrow-down\': ((!metaMediaViewer.pagination.arrowsDirection || metaMediaViewer.pagination.arrowsDirection === \'top\') && metaMediaViewer.pages.showBox) || (metaMediaViewer.pagination.arrowsDirection === \'bottom\' && !metaMediaViewer.pages.showBox), \'icon-vw-arrow-up\': ((!metaMediaViewer.pagination.arrowsDirection || metaMediaViewer.pagination.arrowsDirection === \'top\') && !metaMediaViewer.pages.showBox) || (metaMediaViewer.pagination.arrowsDirection === \'bottom\' && metaMediaViewer.pages.showBox) }"></span></div><div class="box-inline btn-nav btn-next" ng-class="{\'not-visible\': !metaMediaViewer.next, \'disabled\':metaMediaViewer.loadingMedia}" ng-click="metaMediaViewer.pages.goNext()"><i class="icon-vw-angle-right"></i></div><div class="box-inline btn-nav btn-last" ng-click="metaMediaViewer.pages.goToLast()" ng-class="{\'disabled\':metaMediaViewer.loadingMedia}"><i class="icon-vw-angle-double-right"></i></div></div></div>'),e.put("app/components/metaMediaViewerCustom/popover/cart.html",'<div class="block-pop-up-ecommerce"><div class="triangle"></div><div class="block-pop-up-content"><iframe frameborder="0" src="http://52.48.173.171/polofe_dev/it/152/?id=2842728&type=iccd&mediaId=f2bd99fd-aec6-45c1-9113-292cd0889494"></iframe></div></div>')}]);